âºï¸ â¡ï¸ ğŸŸ¦ ğŸ”µğŸ”¹ğŸ”· ğŸ”µ â˜‘ï¸ âœ”ï¸ ğŸ”´ ğŸŸ  ğŸŸ¡ ğŸŸ¢ â­• â€¢ â€£ â†’ â•

# âºï¸ Deployment

- A Deployment ensures that your desired number of pod replicas are running.
- **Handles:**
  - Scaling up/down
  - Rolling updates
  - Rollbacks
  - It's how you deploy and manage pods in a controlled way.

#### Deployment.yaml

- It is called maneifest file

```yml
apiVersion: apps/v1 # API version used
kind: Deployment # Type of resource
metadata: # Metadata about the deployment
  name: my-app-deployment # Name of the deployment
  labels:
    app: my-app # Label to identify the deployment
spec: # Specification of the deployment
  replicas: 3 # ReplicaSet
  selector: # How to identify pods managed by this deployment
    matchLabels:
      app: my-app
  template: # Pod template
    metadata:
      labels:
        app: my-app # Label for pods
    spec: # Specification for the pod
      containers:
        - name: my-app-container
          image: nginx:latest # Container image to run
          ports:
            - containerPort: 80 # Port exposed by the container
```

## â¡ï¸ Meaning Of Each Line Of Instruction:

| Field        | Description                                              |
| ------------ | -------------------------------------------------------- |
| `apiVersion` | API version (`apps/v1` for deployments)                  |
| `kind`       | Resource type (`Deployment`)                             |
| `metadata`   | Name and labels for identification                       |
| `spec`       | Defines the desired state (replicas, selector, template) |

### ğŸŸ¦ replica

- Number of pods running in the deployment

### ğŸŸ¦ selector

- manages the pods
- Label `my-app` is defined in the Deployment's `.spec.template` and is matched in the Serive's `selector`

```yml
selector: # How to identify pods managed by this deployment
  matchLabels:
    app: my-app
```

### ğŸŸ¦ template

- label for the Pod is defined in the Deployment's `.spec.template`
- This lable is used in the Deployment's `.spec.selector` and Serive's `.spec.selector`
- Pod name and Pod Id is generated by k8s automatically
- There can be one or more than one containers defined in the `.spec.template`
- And these containers are running inside the Pod

```yml
template: # Pod template
  metadata:
    labels:
      app: my-app
```

### ğŸŸ¦ Ports

- This container(App) is listening on port 80
- It does NOT expose the container outside. The container is reachable through the Service only.
  - `External(Browser / ReactJS) â†’ LoadBalancer/Ingress â†’ Service â†’ Pod (containerPort)`
- This must match the **Serviceâ€™s** `ports.targetPort` in ServiceğŸŸ 

```yml
ports:
  - containerPort: 80
```

| Field        | Description                        |
| ------------ | ---------------------------------- |
| `containers` | List of containers inside each pod |
| `image`      | Docker image used in the container |

## â¡ï¸ Commands

| #   | Command                                                      | Description                                                               |
| --- | ------------------------------------------------------------ | ------------------------------------------------------------------------- |
| 1   | `kubectl get pods`                                           | Lists all pods in the current namespace.                                  |
| 2   | `kubectl get deployments`                                    | Lists all deployments.                                                    |
| 3   | `kubectl get services`                                       | Lists all services.                                                       |
| 4   | `kubectl apply -f <file>.yaml`                               | Creates or updates resources defined in the YAML file.                    |
| 5   | `kubectl delete -f <file>.yaml`                              | Deletes resources defined in the YAML file.                               |
| 6   | `kubectl describe pod <pod-name>`                            | Shows detailed information about a specific pod.                          |
| 7   | `kubectl logs <pod-name>`                                    | Displays logs for a pod's main container.                                 |
| 8   | `kubectl exec -it <pod-name> -- bash`                        | Executes an interactive shell inside the pod.                             |
| 9   | `kubectl scale deployment <name> --replicas=N`               | Scales a deployment to N replicas.                                        |
| 10  | `kubectl expose deployment <name> --type=NodePort --port=80` | Exposes a deployment as a service on a node port.                         |
| 11  | `kubectl get all`                                            | Lists all resources (pods, services, deployments, etc.) in the namespace. |
| 12  | `kubectl edit deployment <name>`                             | Opens the deployment configuration in a text editor for live changes.     |
| 13  | `kubectl port-forward pod/<pod-name> 8080:80`                | Forwards port 80 from the pod to localhost:8080.                          |
| 14  | `kubectl get namespaces`                                     | Lists all namespaces in the cluster.                                      |
| 15  | `kubectl config set-context --current --namespace=<ns>`      | Sets the default namespace for your kubectl context.                      |
